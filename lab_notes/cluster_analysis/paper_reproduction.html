
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Paper reproduction &#8212; asd_strat 0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lab_notes/cluster_analysis/paper_reproduction';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Initial phenotypic cluster analysis" href="initial_pheno.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">asd_strat 0.1.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../packages.html">
    Packages
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../lab_notes.html">
    Laboratory notes
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../packages.html">
    Packages
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../lab_notes.html">
    Laboratory notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../regression.html">Regression</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../cluster_analysis.html">Cluster analysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="initial_pheno.html">Initial phenotypic cluster analysis</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Paper reproduction</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../lab_notes.html" class="nav-link">Laboratory notes</a></li>
    
    
    <li class="breadcrumb-item"><a href="../cluster_analysis.html" class="nav-link">Cluster analysis</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Paper reproduction</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="paper-reproduction">
<h1>Paper reproduction<a class="headerlink" href="#paper-reproduction" title="Link to this heading">#</a></h1>
<p>We attempt to reproduce the results of the Litman et al. paper titled <em>Decomposition of phenotypic heterogeneity
in autism reveals underlying genetic programs</em> <a class="footnote-reference brackets" href="#paper" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. The code and script used in this paper was accessed
from <a class="reference external" href="https://github.com/FunctionLab/asd-pheno-classes">GitHub</a>.</p>
<section id="feature-selection">
<h2>Feature selection<a class="headerlink" href="#feature-selection" title="Link to this heading">#</a></h2>
<p>The list of features used in the paper was obtained from using a code generation function injected into the preprocessing script <a class="footnote-reference brackets" href="#script" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> at line 127, before dataframes were integrated.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;SCQ_FEATURES = [&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;    Feat.SCQ_</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">,&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">scqdf</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;]&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;BHC_FEATURES = [&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;    Feat.BHC_</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">,&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">bhcdf</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;]&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;BHS_FEATURES = [&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;    Feat.BHS_</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">,&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">bhsdf</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;]&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;RBSR FEATURES = [&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;    Feat.RBSR_</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">,&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">rbsr</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;]&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;CBCL_6_18_FEATURES = [&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;    Feat.CBCL_6_18_</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">,&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cbcl_2</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;]&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<p>These features were joined using the <a class="reference internal" href="../../packages/spark/dataset.html#spark.spark.SPARK.init_and_join" title="spark.spark.SPARK.init_and_join"><code class="xref py py-attr docutils literal notranslate"><span class="pre">init_and_join</span></code></a> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ASD column was omitted from <a class="reference internal" href="../../packages/spark/instrument.html#spark.inst.Inst.BHC" title="spark.inst.Inst.BHC"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BHC</span></code></a>, as it was already included by <a class="reference internal" href="../../packages/spark/instrument.html#spark.inst.Inst.SCQ" title="spark.inst.Inst.SCQ"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SCQ</span></code></a>, mirroring how Duplicated columns are removed in the preprocessing script <a class="footnote-reference brackets" href="#script" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
</div>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h2>
<p>Inclusion criteria ascertained from the preprocessing script <a class="footnote-reference brackets" href="#script" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> involve:</p>
<ul class="simple">
<li><p>An <a class="reference internal" href="../../packages/spark/instrument.html#spark.inst.Inst.SCQ" title="spark.inst.Inst.SCQ"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SCQ</span></code></a> age of evaluation range of 4–18 years.</p></li>
<li><p>An <a class="reference internal" href="../../packages/spark/instrument.html#spark.inst.Inst.BHC" title="spark.inst.Inst.BHC"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BHC</span></code></a> age of evaluation range of 4–18 years.</p></li>
</ul>
<p>Data transformations include:</p>
<ul class="simple">
<li><p>Mapping of male sex assigned at birth to 1, female sex assigned at birth to 0.</p></li>
<li><p>Serialising categorical variables into numerical values.</p></li>
</ul>
<p>Exclusion criteria include:</p>
<ul class="simple">
<li><p>Columns where more than 10% of the values are missing</p></li>
<li><p>Rows with any missing values.</p></li>
</ul>
<p>The preprocessing metrics are shown below, including the male to female split:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Reproduction</p></th>
<th class="head"><p>Original Paper</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Number of subjects</p></td>
<td><p>27688</p></td>
<td><p>9094</p></td>
</tr>
<tr class="row-odd"><td><p>Number of features</p></td>
<td><p>108</p></td>
<td><p>247</p></td>
</tr>
<tr class="row-even"><td><p>Male subjects</p></td>
<td><p>21416</p></td>
<td><p>6818</p></td>
</tr>
<tr class="row-odd"><td><p>Female subjects</p></td>
<td><p>6272</p></td>
<td><p>2276</p></td>
</tr>
</tbody>
</table>
</div>
<p>Observations include a 3-fold increase in subject count, but a loss of 139 features. The male to female proportions have stayed roughly the same. These observed differences are likely due to the use of a more recent release of SPARK (<code class="docutils literal notranslate"><span class="pre">2025-03-31</span></code> oppose to the original paper’s <code class="docutils literal notranslate"><span class="pre">2022-12-12</span></code>).
Raising the maximum missing value threshold from 10% to 30% only yields 6 more features, which indicates that there are many more subjects who have joined the study, but have not completed all the instruments.</p>
<p>When comparing the subject identifiers between the original and the reproduction, we find that 96.4% of the subjects in the original paper are also present in the reproduction. The individuals who are not present in the reproduction may have requested their data be removed, may have found to be erroneous.</p>
</section>
<section id="fit-results">
<h2>Fit results<a class="headerlink" href="#fit-results" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Original paper</p></th>
<th class="head"><p>Original identifiers</p></th>
<th class="head"><p>All identifiers</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sample size</p></td>
<td><p>5392</p></td>
<td><p>8767</p></td>
<td><p>27688</p></td>
</tr>
<tr class="row-odd"><td><p>Case weights</p></td>
<td><p>37%, 34%, 19%, 10%</p></td>
<td><p>31%, 27%, 25%, 16%</p></td>
<td><p>52%, 27%, 14%, 6%</p></td>
</tr>
<tr class="row-even"><td><p>Number of estimated parameters</p></td>
<td></td>
<td><p>10229</p></td>
<td><p>9049</p></td>
</tr>
<tr class="row-odd"><td><p>Sacled relative entropy</p></td>
<td></td>
<td><p>0.9780</p></td>
<td><p>0.9783</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="paper" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Litman A, Sauerwald N, Green Snyder L, Foss-Feig J, Park CY, Hao Y, et al. Decomposition of phenotypic heterogeneity in autism reveals underlying genetic programs. Nat Genet. 2025 Jul 9;1–9.</p>
</aside>
<aside class="footnote brackets" id="script" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id3">2</a>,<a role="doc-backlink" href="#id4">3</a>)</span>
<p><a class="reference external" href="https://github.com/FunctionLab/asd-pheno-classes/blob/main/PreprocessingScripts/process_integrate_phenotype_data.py">asd-pheno-classes/PreprocessingScripts/process_integrate_phenotype_data.py</a></p>
</aside>
</aside>
</section>
<section id="module-asd_strat.commands.paper_reproduction">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-asd_strat.commands.paper_reproduction" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="asd_strat.commands.paper_reproduction.find_optimal_k">
<span class="sig-prename descclassname"><span class="pre">asd_strat.commands.paper_reproduction.</span></span><span class="sig-name descname"><span class="pre">find_optimal_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_descriptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#asd_strat.commands.paper_reproduction.find_optimal_k" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="asd_strat.commands.paper_reproduction.get_original_subject_sp_ids">
<span class="sig-prename descclassname"><span class="pre">asd_strat.commands.paper_reproduction.</span></span><span class="sig-name descname"><span class="pre">get_original_subject_sp_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#asd_strat.commands.paper_reproduction.get_original_subject_sp_ids" title="Link to this definition">#</a></dt>
<dd><p>Retrieves the original subject identifiers used by the paper from a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A set of unique subject identifiers read from the file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>set[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="asd_strat.commands.paper_reproduction.paper_reproduction">
<span class="sig-prename descclassname"><span class="pre">asd_strat.commands.paper_reproduction.</span></span><span class="sig-name descname"><span class="pre">paper_reproduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_original_ids:</span> <span class="pre">~typing.Annotated[bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f26fb957610&gt;]</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_frac:</span> <span class="pre">~typing.Annotated[float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f26fb957750&gt;]</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark_pathname:</span> <span class="pre">~typing.Annotated[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f26fb957890&gt;]</span> <span class="pre">=</span> <span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_pathname:</span> <span class="pre">~typing.Annotated[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f26fb9579d0&gt;]</span> <span class="pre">=</span> <span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_pathname:</span> <span class="pre">~typing.Annotated[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f26fb957b10&gt;]</span> <span class="pre">=</span> <span class="pre">'.'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#asd_strat.commands.paper_reproduction.paper_reproduction" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="asd_strat.commands.paper_reproduction.run_model">
<span class="sig-prename descclassname"><span class="pre">asd_strat.commands.paper_reproduction.</span></span><span class="sig-name descname"><span class="pre">run_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_descriptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">StepMix</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Series</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#asd_strat.commands.paper_reproduction.run_model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="asd_strat.commands.paper_reproduction.run_preprocessing">
<span class="sig-prename descclassname"><span class="pre">asd_strat.commands.paper_reproduction.</span></span><span class="sig-name descname"><span class="pre">run_preprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark_pathname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_original_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../../packages/spark/dataset.html#spark.spark.SPARK" title="spark.spark.SPARK"><span class="pre">SPARK</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../packages/spark/instrument.html#spark.inst.Inst" title="spark.inst.Inst"><span class="pre">Inst</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#asd_strat.commands.paper_reproduction.run_preprocessing" title="Link to this definition">#</a></dt>
<dd><p>Reproduces the paper’s preprocessing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spark_pathname</strong> – The SPARK data release directory pathname.</p></li>
<li><p><strong>use_original_ids</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag indicating whether to filter only original subject IDs. Defaults to True.</p></li>
<li><p><strong>round_values</strong> – A flag indicating whether to round the dataframe to the nearest integer. Defaults to True.</p></li>
<li><p><strong>sample_frac</strong> – The proportion of the dataset to sample. Defaults to 0.05 (5%).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the preprocessed dataframe, the dataset, and a list of instruments used during processing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pd.DataFrame, <a class="reference internal" href="../../packages/spark/dataset.html#spark.spark.SPARK" title="spark.spark.SPARK">SPARK</a>, list[<a class="reference internal" href="../../packages/spark/instrument.html#spark.inst.Inst" title="spark.inst.Inst">Inst</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="asd_strat.commands.paper_reproduction.split_dataframe_columns_by_type">
<span class="sig-prename descclassname"><span class="pre">asd_strat.commands.paper_reproduction.</span></span><span class="sig-name descname"><span class="pre">split_dataframe_columns_by_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_unique_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#asd_strat.commands.paper_reproduction.split_dataframe_columns_by_type" title="Link to this definition">#</a></dt>
<dd><p>Classify the columns of a DataFrame as binary, categorical, or continuous.</p>
<p>Binary columns are those with unique non-null values subset of {0.0, 1.0}.
Categorical columns have unique values less than or equal to the threshold.
Continuous columns are the remaining ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The DataFrame whose columns are to be classified.</p></li>
<li><p><strong>cat_unique_threshold</strong> (<em>int</em>) – The maximum number of unique values for a column to be considered categorical.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of three lists: (binary columns, continuous columns, categorical columns)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[list[str], list[str], list[str]]</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="initial_pheno.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Initial phenotypic cluster analysis</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-selection">Feature selection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-results">Fit results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-asd_strat.commands.paper_reproduction">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asd_strat.commands.paper_reproduction.find_optimal_k"><code class="docutils literal notranslate"><span class="pre">find_optimal_k()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asd_strat.commands.paper_reproduction.get_original_subject_sp_ids"><code class="docutils literal notranslate"><span class="pre">get_original_subject_sp_ids()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asd_strat.commands.paper_reproduction.paper_reproduction"><code class="docutils literal notranslate"><span class="pre">paper_reproduction()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asd_strat.commands.paper_reproduction.run_model"><code class="docutils literal notranslate"><span class="pre">run_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asd_strat.commands.paper_reproduction.run_preprocessing"><code class="docutils literal notranslate"><span class="pre">run_preprocessing()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asd_strat.commands.paper_reproduction.split_dataframe_columns_by_type"><code class="docutils literal notranslate"><span class="pre">split_dataframe_columns_by_type()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/lab_notes/cluster_analysis/paper_reproduction.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Tahmid Azam.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>